<?xml version="1.0"?>

<project name="editor" basedir="." default="compile">
	<property name="project.dir" value="../.." />

	<import file="${project.dir}/build-common-java.xml" />

	<property name="deploy.dir" value="${applets.dir}" />
	<property name="jar.file" value="${ant.project.name}.jar" />

	<target name="compile">

		<!--
		The editor applet cannot properly compile with Jikes.
		-->

		<mkdir dir="${classes.dir}" />
		<javac
			classpathref="project.classpath"
			debug="${javac.debug}"
			deprecation="${javac.deprecation}"
			destdir="${classes.dir}"
			nowarn="${javac.nowarn}"
			srcdir="${source.dir}"
			source="1.3"
			target="1.3"
		/>
	</target>

	<target name="jar" depends="compile">
		<jar
			basedir="${classes.dir}"
			jarfile="${jar.file}"
		/>

		<antcall target="signjar" />
	</target>

	<target name="signjar" if="signjar.alias">

		<!--
		The SignJar task assumes you have already generated a valid alias. To
		generate a key for a specified alias, type:

		keytool -genkey -alias ${signjar.alias}
		-->

		<signjar
			jar="${jar.file}"
			alias="${signjar.alias}"
			storepass="${signjar.password}"
			signedjar="${ant.project.name}-signed.jar"
		/>
	</target>

	<target name="deploy" depends="jar">
		<copy todir="${deploy.dir}">
			<fileset
				dir="."
				includes="${ant.project.name}*.jar"
			/>
		</copy>
	</target>

	<target name="run" depends="compile">
		<java
			classname="com.liferay.applets.editor.Editor"
			classpathref="project.classpath"
			fork="true"
		/>
	</target>
</project>